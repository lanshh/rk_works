From d7878cdf89f7a1fbc6a70bfcf6bcdb70988cac74 Mon Sep 17 00:00:00 2001
From: lanshh <lsh@rock-chips.com>
Date: Mon, 23 Oct 2017 10:41:20 +0800
Subject: [PATCH] enable emmc in kernel

Change-Id: I0a07307320fbc0d99778fbc2b07c628bb595aef7
Signed-off-by: lanshh <lsh@rock-chips.com>
---
 arch/arm/boot/dts/rv1108-camb-v13.dtsi | 4 ++--
 arch/arm/boot/dts/rv1108-evb-v13.dts   | 4 ++--
 arch/arm/configs/rv1108_ipc_defconfig  | 2 +-
 3 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/arch/arm/boot/dts/rv1108-camb-v13.dtsi b/arch/arm/boot/dts/rv1108-camb-v13.dtsi
index bbc8d27..ea350fd 100644
--- a/arch/arm/boot/dts/rv1108-camb-v13.dtsi
+++ b/arch/arm/boot/dts/rv1108-camb-v13.dtsi
@@ -39,9 +39,9 @@ camera1: camera-module@36-1 {
 	pinctrl-names = "rockchip,camera_default", "rockchip,camera_sleep";
 	pinctrl-0 = <&cif_dvp_clk_out>;
 	pinctrl-1 = <&cif_dvp_clk_out_sleep>;
-	rockchip,pd-gpio = <&gpio3 GPIO_B0 GPIO_ACTIVE_LOW>;
+	rockchip,pd-gpio = <&gpio3 GPIO_D1 GPIO_ACTIVE_LOW>;
 	rockchip,pwr-gpio = <&gpio3 GPIO_B5 GPIO_ACTIVE_HIGH>;
-	rockchip,rst-gpio = <&gpio3 GPIO_D1 GPIO_ACTIVE_LOW>;
+	rockchip,rst-gpio = <&gpio3 GPIO_B0 GPIO_ACTIVE_LOW>;
 	rockchip,camera-module-mclk-name = "clk_cif_out";
 	rockchip,camera-module-facing = "back";
 	rockchip,camera-module-name = "LA6111PA";
diff --git a/arch/arm/boot/dts/rv1108-evb-v13.dts b/arch/arm/boot/dts/rv1108-evb-v13.dts
index f684f8c..84b64f1 100644
--- a/arch/arm/boot/dts/rv1108-evb-v13.dts
+++ b/arch/arm/boot/dts/rv1108-evb-v13.dts
@@ -81,7 +81,7 @@
 	};
 
 	chosen {
-		bootargs = "user_debug=31 rockchip_jtag noinitrd root=/dev/mtdblock3 rootfstype=squashfs";
+		bootargs = "user_debug=31 rockchip_jtag noinitrd root=/dev/mmcblk0p4 rootfstype=squashfs";
 	};
 
 	ion {
@@ -202,7 +202,7 @@
 		/*lkg(mA)  volt(uV)*/
 		60         25000
 		>;
-	status = "okay";
+	status = "disabled";
 };
 
 &watchdog {
diff --git a/arch/arm/configs/rv1108_ipc_defconfig b/arch/arm/configs/rv1108_ipc_defconfig
index 0bce503..cef9c8c 100644
--- a/arch/arm/configs/rv1108_ipc_defconfig
+++ b/arch/arm/configs/rv1108_ipc_defconfig
@@ -295,6 +295,7 @@ CONFIG_RK_NANDC_NAND=y
 CONFIG_RK_SFC_NOR=y
 CONFIG_RK_SFC_NAND=y
 CONFIG_RK_SFC_NOR_MTD=y
+CONFIG_EXT4_FS=y
 CONFIG_MSDOS_FS=y
 CONFIG_VFAT_FS=y
 CONFIG_TMPFS=y
@@ -324,6 +325,5 @@ CONFIG_CRYPTO_SHA256=y
 CONFIG_CRYPTO_DEV_ROCKCHIP=y
 CONFIG_CRYPTO_DEV_ROCKCHIP_ENCRYPT=y
 CONFIG_CRC_CCITT=y
-CONFIG_CRC16=y
 CONFIG_CRC_ITU_T=y
 CONFIG_LIBCRC32C=y
-- 
1.9.1

