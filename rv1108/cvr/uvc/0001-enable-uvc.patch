From 21843ea6616785c84517de647dd6f32e58ba59f7 Mon Sep 17 00:00:00 2001
From: lanshh <lsh@rock-chips.com>
Date: Fri, 2 Jun 2017 17:44:14 +0800
Subject: [PATCH] enable uvc

Change-Id: I25cf31ed20aa4346bd3d2ea15b22fe98127d2b8a
Signed-off-by: lanshh <lsh@rock-chips.com>
---
 parameter.c | 4 ++++
 video.cpp   | 2 +-
 video.h     | 2 +-
 3 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/parameter.c b/parameter.c
index b1f6d40..964c6c5 100644
--- a/parameter.c
+++ b/parameter.c
@@ -1007,6 +1007,10 @@ int parameter_init(void)
 #endif
 
     ret = parameter_param_read();
+    parameter.video_3dnr = 0;
+    parameter.video_idc = 0;
+    parameter.video_usb = 2;
+
     if (ret == -1)
         return parameter_recover();
     if (ret == -2)
diff --git a/video.cpp b/video.cpp
index cee810e..c9117bf 100644
--- a/video.cpp
+++ b/video.cpp
@@ -3449,7 +3449,7 @@ int isp_video_path_mp(struct Video* video)
         return -1;
     }
     video->hal->mpath->addBufferNotifier(video->hal->nv12_rga.get());
-    video->hal->nv12_rga->prepare(video->frmFmt, 4, video->hal->bufAlloc);
+    video->hal->nv12_rga->prepare(video->frmFmt, 2, video->hal->bufAlloc);
 
     video->hal->nv12_uvc = shared_ptr<NV12_UVC>(new NV12_UVC(video));
     if (!video->hal->nv12_uvc.get()) {
diff --git a/video.h b/video.h
index c6dd295..bf35b84 100644
--- a/video.h
+++ b/video.h
@@ -12,7 +12,7 @@ extern "C" {
 #define CMD_PHOTOEND                2
 
 #define USE_1440P_CAMERA 0
-#define USE_USB_WEBCAM 0
+#define USE_USB_WEBCAM 1
 
 #define ISP_SP_WIDTH 640
 #define ISP_SP_HEIGHT 360
-- 
1.9.1

